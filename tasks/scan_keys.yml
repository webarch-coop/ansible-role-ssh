---
- name: Scan SSH key fingerprints
  block:

    - name: Scan keys available on the default IPv4 address
      ansible.builtin.command: "ssh-keyscan {{ ansible_default_ipv4.address }}"
      check_mode: false
      changed_when: false
      when: ansible_default_ipv4.address is defined
      register: ssh_keyscan_ipv4

    - name: Debug the keys available on the default IPv4 address
      ansible.builtin.debug:
        var: ssh_keyscan_ipv4.sdtout
        verbosity: 2

    - name: Scan keys available on the default IPv6 address
      ansible.builtin.command: "ssh-keyscan {{ ansible_default_ipv6.address }}"
      check_mode: false
      changed_when: false
      when: ansible_default_ipv6.address is defined
      register: ssh_keyscan_ipv6
  
    - name: Debug the keys available on the default IPv6 address
      ansible.builtin.debug:
        var: ssh_keyscan_ipv6.sdtout
        verbosity: 2

  tags:
    - ssh
    - ssh_keyscan
...
